---
marp: true
theme: seals
---
<!--
_class: first
-->
# 楽曲生成アプリ作るよ！
まなさす

---
<!--
_class: title
-->
# 動画にあった自動作曲したい
---

# 技術選定
- デスクトップアプリにする
  - サーバで動画解析とどうしてもサーバサイドの稼働時間かかるため
- WEBサービス化もいつかしたい
- 将来的に機械学習も活用したい

---
<!--
_class: title
-->

# Electron + Next.js + Python

--- 

|技術|選定理由|
|------|--------------|
|Electron|WEBサービス化も諦めてないデスクトップアプリならほぼ一択。<br>DiscrodやSlackにも採用されている安心感|
|Next.js|今仲良くしたいフロントエンドFWナンバーワン|
|Python|MLできる & midiライブラリが強め & 画像解析も強い<br>Rustも興味あったが、midiライブラリが弱めだった|

---
<!--
_class: title
-->
# やりました
---

# Electron + Next.js ひっかかりどころ
- Inputのモーダルなど『OS依存』なものがそのまま使えない
  - ブラウザではブラウザが呼び出し処理を実施してくれている
    - Electronの機能はあるので、IPC通信で呼び出す
    - Electronもtsで書けるので、ts書ける人なら問題なし
  - ダウンロードリンク踏むとダウンロードもIPC通信必要
- 他は普通のNext.jsです

---
# Electron + Python

- 最初のキックがElectronからになるだけで、あとは普通に実装
- CORS対応忘れずに
- バックエンドの起動が遅くて起動直後APIが迷子になるのでそこの対策は必要

--- 
# 【おまけ】Pythonで動画から作曲
- OpenCV + pretty_midi ( + fluidsynth )でやる
1. OpenCVで動画処理して色や動画の動きなどの特徴をとる
1. それをルールベースで音楽に反映
    - 赤→長調、青→短調とか。
    - 動きが多い→テンポはやい、動きがすくない→テンポおそいとか
- 動きの緩急にあってればそれっぽく聞こえるはず

--- 
# おわりに
- フロントエンドもバックエンドも好きな言語・FWで構成できるので元の技術スタック使いやすくてかなり便利。
  - デスクトップアプリ作ってみたい人に激推し
- フロントエンド側はOS依存のところだけは実装がちょっと特殊だけど
  - ブラウザのありがたみを改めて感じられる良い機会にもなった